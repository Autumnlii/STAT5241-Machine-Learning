infIndexPlot(m5)
infIndexPlot(m5,vars = "cook")
# Cook's D plot
# identify D values > 4/(n-k-1)
cutoff <- 4/((nrow(SENIC)-length(m1$coefficients)-2))
plot(m5, which=4, cook.levels=cutoff)
library(car)
x= c(1,30,58,2)
?nlm
?diff
resoduals(lm(x~y))
residuals(lm(x~y))
？lm
?lm
？unique
?unique
?aaply
?aaply
libary(plyr)
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
detach("package:plyr", unload=TRUE)
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
?aaply
dim(ozone)
aaply(ozone, 1, mean)
aaply(ozone, 1, mean, .drop = FALSE)
aaply(ozone, 3, mean)
aaply(ozone, c(1,2), mean)
dim(aaply(ozone, c(1,2), mean))
dim(aaply(ozone, c(1,2), mean, .drop = FALSE))
aaply(ozone, 1, each(min, max))
aaply(ozone, 1, each(min, max))
dim(aaply(ozone, 1, mean))
aaply(ozone, 1, mean)
aaply(ozone, c(1,2), mean)
dim(aaply(ozone, 1, mean))
?signif
?nls
12*3.3+15*3.7
95.1/27
Senic
SENIC <- read.table("~/Desktop/2016 fall/regression/data/SENIC.txt", header=TRUE, quote="\"")
View(SENIC)
SENIC <- read.table("~/Desktop/2016 fall/regression/data/SENIC.txt", header=TRUE, quote="\"")
hist(SENIC$Stay)
plot(SENIC$Stay,SENIC$Age)
mean(SENIC$Stay)
summary(SENIC$Stay)
plot(SENIC$Stay,SENIC$Age,col = "red")
install.packages("BSDA")
SENIC <- read.table("~/Desktop/data/SENIC.txt", header=TRUE, quote="\"")
View(SENIC)
getOption()
getOption("repos")
install.packages("rmarkdown")
install.packages("rmarkdown")
library("alr3", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("ggbiplot", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("MASS", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("quantmod", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
install.packages("rmarkdown")
library(rmarkdown)
install.packages("devtools")
devtools::install_github("rstudio/rmarkdown")
getOption("repos")
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.3.tar.gz")
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.0.tar.gz")
library(rmarkdown)
install.packages("devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.0.tar.gz")")
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.0.tar.gz")
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.0.tar.gz")
options(repos = c(CRAN = "https://cran.revolutionanalytics.com"))
install.packages("rmarkdown", contriburl = "http://cran.r-project.org/src/contrib", type = "source")
install.packages("rmarkdown", contriburl = "http://cran.r-project.org/src/contrib", type = "source")
options(repos = c(CRAN = "https://cran.revolutionanalytics.com"))
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.3.tar.gz")
install.packages(rmakdown)
install.packages(rmarkdown)
install.packages(rmarkdown)
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.3.tar.gz")
install.packages("rmarkdown")
library(rmarkdown)
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown0.5.1.tar.gz")
devtools::install_url("http://cran.r-project.org/src/contrib/rmarkdown_1.3.tar.gz")
R
knitr::opts_chunk$set(echo = TRUE)
credit = read.csv("credit.csv", head = TRUE )
setwd("~/Desktop/2017 spring/GR 5241/HW/HW1")
setwd("~/Desktop/2017 spring/GR 5241/HW/HW1")
credit = read.csv("credit.csv", head = TRUE )
head(credit)
balance = credit$Balance
library(leaps)
lm3 = regsubsets(balance ~., data = credit)
library(leaps)
install.packages("leaps")
install.packages("leaps")
library(leaps)
lm3 = regsubsets(balance ~., data = credit)
summary(lm3)$rss
summary(lm3)$bic
summary(lm3)$cp
lm4 = regsubsets(balance ~., data = credit,method = "forward")
summary(lm4)$rss
summary(lm4)$bic
summary(lm4)$cp
lm5 = regsubsets(balance ~., data = credit,method = "backward")
summary(lm5)$rss
summary(lm5)$bic
summary(lm5)$cp
par(mfrow = c(1,1))
plot(summary(lm3)$rss,col = "red")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot.new
？plot.new
?plot.new
plot.new(plot(summary(lm3)$rss,col = "red"))
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot.new(points(summary(lm4)$rss,col = "blue"))
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot(summary(lm3)$rss,col = "red")
print(summary(lm4)$rss,col = "blue")
points(summary(lm4)$rss,col = "blue")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
?legend
leg.txt = c("optional","forward","backward ")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
leg.txt = c("optional","forward","backward ")
legend("bottomright",leg.txt,pch = 1)
legend("bottomright",leg.txt,pch = 1,col = fill)
legend("bottomright",leg.txt,pch = 1,col= c("red","blue","green"))
?legend
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
leg.txt = c("optional","forward","backward ")
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
plot(summary(lm3)$rss,col = "red",main = "RSS of three mehods",ylab = "RSS")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
leg.txt = c("optional","forward","backward ")
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
plot(summary(lm3)$rss,col = "red")
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
?plot.new
plot.new(summary(lm3)$rss,col = "red")
plot(summary(lm3)$rss,col = "red")
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/2017 spring/GR 5241/HW/HW1")
credit = read.csv("credit.csv", head = TRUE )
head(credit)
balance = credit$Balance
library(MASS)
install.packages("leaps")
install.packages("leaps")
library(MASS)
library(leaps)
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
plot(summary(lm3)$rss,col = "red")
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
plot(pressure)
```{r credit, include=FALSE}
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
plot(summary(lm3)$rss,col = "red")
points(summary(lm4)$rss,col = "blue")
par(mfrow = c(2,3))
plot(lm3,scale = "Cp")
par(mfrow = c(1,3))
plot(lm3,scale = "Cp")
plot(lm4,scale = "Cp")
plot(lm5,scale = "Cp")
plot(lm3,scale = "bic")
plot(lm4,scale = "bic")
plot(lm5,scale = "bic")
par(mfrow = c(1,3))
plot(lm3,scale = "Cp")
plot(lm4,scale = "Cp")
plot(lm5,scale = "Cp")
plot(lm3,scale = "bic")
plot(lm4,scale = "bic")
plot(lm5,scale = "bic")
summary(lm3,scale = "Cp")
summary(lm4,scale = "Cp")
summary(lm5,scale = "Cp")
summary(lm3,scale = "bic")
summary(lm4,scale = "bic")
summary(lm5,scale = "bic")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/2017 spring/GR 5241/HW/HW1")
credit = read.csv("credit.csv", head = TRUE )
head(credit)
balance = credit$Balance
library(MASS)
library(leaps)
lm3 = regsubsets(balance ~., data = credit)
summary(lm3)$rss
summary(lm3)$bic
summary(lm3)$cp
lm4 = regsubsets(balance ~., data = credit,method = "forward")
summary(lm4)$rss
summary(lm4)$bic
summary(lm4)$cp
lm5 = regsubsets(balance ~., data = credit,method = "backward")
summary(lm5)$rss
summary(lm5)$bic
summary(lm5)$cp
par(mfrow = c(1,1))
plot(summary(lm3)$rss,col = "red")
#points(summary(lm4)$rss,col = "blue")
#points(summary(lm5)$rss,col = "green")
#legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
sym1 = c("MMM","AXP","AAPL","BA","CAT","CVX","CSCO","KO","DD","XOM","GE",
"GS","HD","IBM","INTC","JNJ","JPM","MCD","MRK","MSFT","NKE","PFE",
"PG","TRV","UNH","UTX","VZ","V","WMT","DIS")
web = NULL
title = NULL
stock = NULL
for (i in 1:length(sym1)){
web[i] = paste("http://chart.finance.yahoo.com/table.csv?s=", sym1[i],"&a=0&b=1&c=2010&d=0&e=1&f=2011&g=d&ignore=.csv",sep = "")
title[i] = paste(sym1[i],".csv",sep = "")
download.file (web[i],title,quiet = FALSE)
}
d = c(1:252)
pr= matrix(d,nrow = 252,ncol = 30)
colnames(d) = c("mmm","aapl")
for( i in 1:length(sym1))
{
stock = read.csv(title[i],header = T)
m = stock$Adj.Close
pr[,i] = m
}
colnames(pr) = sym1
str(pr)
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/2017 spring/GR 5241/HW/HW1")
credit = read.csv("credit.csv", head = TRUE )
head(credit)
balance = credit$Balance
library(MASS)
library(leaps)
lm3 = regsubsets(balance ~., data = credit)
summary(lm3)$rss
summary(lm3)$bic
summary(lm3)$cp
lm4 = regsubsets(balance ~., data = credit,method = "forward")
summary(lm4)$rss
summary(lm4)$bic
summary(lm4)$cp
lm5 = regsubsets(balance ~., data = credit,method = "backward")
summary(lm5)$rss
summary(lm5)$bic
summary(lm5)$cp
par(mfrow = c(1,1))
plot(summary(lm3)$rss,col = "red")
#points(summary(lm4)$rss,col = "blue")
#points(summary(lm5)$rss,col = "green")
#legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/2017 spring/GR 5241/HW/HW1")
credit = read.csv("credit.csv", head = TRUE )
head(credit)
balance = credit$Balance
library(MASS)
library(leaps)
lm3 = regsubsets(balance ~., data = credit)
summary(lm3)$rss
summary(lm3)$bic
summary(lm3)$cp
lm4 = regsubsets(balance ~., data = credit,method = "forward")
summary(lm4)$rss
summary(lm4)$bic
summary(lm4)$cp
lm5 = regsubsets(balance ~., data = credit,method = "backward")
summary(lm5)$rss
summary(lm5)$bic
summary(lm5)$cp
par(mfrow = c(1,1))
plot(summary(lm3)$rss,col = "red")
#points(summary(lm4)$rss,col = "blue")
#points(summary(lm5)$rss,col = "green")
#legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
pca2 = princomp(pr, cor = T,center = TRUE,scale. = TRUE)
pca2 = princomp(pr, cor = T,center = TRUE,scale. = TRUE)
biplot(pca2)
screeplot(pca2)
biplot(pca1)
screeplot(pca1)
biplot(pca2)
screeplot(pca2)
biplot(pca2)
screeplot(pca2)
pca1 = princomp(pr, cor = F)
biplot(pca1)
screeplot(pca1)
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
?princomp
pca1 = princomp(~., data = pr, cor = FALSE,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
View(pr)
sym1 = c("MMM","AXP","AAPL","BA","CAT","CVX","CSCO","KO","DD","XOM","GE",
"GS","HD","IBM","INTC","JNJ","JPM","MCD","MRK","MSFT","NKE","PFE",
"PG","TRV","UNH","UTX","VZ","V","WMT","DIS")
web = NULL
title = NULL
stock = NULL
for (i in 1:length(sym1)){
web[i] = paste0("http://chart.finance.yahoo.com/table.csv?s=", sym1[i],"&a=0&b=1&c=2010&d=0&e=1&f=2011&g=d&ignore=.csv",sep = "")
title[i] = paste(sym1[i],".csv",sep = "")
download.file (web[i],title,quiet = FALSE)
}
d = c(1:252)
pr= matrix(d,nrow = 252,ncol = 30)
colnames(d) = c("mmm","aapl")
for( i in 1:length(sym1))
{
stock = read.csv(title[i],header = T)
m = stock$Adj.Close
pr[,i] = m
}
colnames(pr) = sym1
str(pr)
web = NULL
title = NULL
stock = NULL
for (i in 1:length(sym1)){
web[i] = paste0("http://chart.finance.yahoo.com/table.csv?s=", sym1[i],"&a=0&b=1&c=2010&d=0&e=1&f=2011&g=d&ignore=.csv",sep = "")
title[i] = paste(sym1[i],".csv",sep = "")
download.file (web[i],title[i],quiet = FALSE)
}
d = c(1:252)
pr= matrix(d,nrow = 252,ncol = 30)
colnames(d) = c("mmm","aapl")
for( i in 1:length(sym1))
{
stock = read.csv(title[i],header = T)
m = stock$Adj.Close
pr[,i] = m
}
colnames(pr) = sym1
str(pr)
View(pr)
par(mfrow = c(1,1))
pca1 = princomp(~., data = pr, cor = FALSE,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
pca1 = princomp(~., data = pr, cor = FALSE,center = TRUE,scale. = TRUE)
pca1 = princomp(pr, cor = FALSE,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
pca2 = princomp(pr, cor = T,center = TRUE,scale. = TRUE)
biplot(pca2)
screeplot(pca2)
return = NULL
for (i in 1:30){
return[i] = exp(diff(log(pr[i]))) - 1
}
return
ret<-exp(diff(log(pr)))-1
ret
ret<-exp(diff(log(pr)))-1
plot(summary(lm3)$rss,col = "red",main = "RSS of three mehods",ylab = "RSS")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
leg.txt = c("optional","forward","backward ")
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
par(mfrow = c(1,3))
plot(lm3,scale = "Cp")
plot(lm4,scale = "Cp")
plot(lm5,scale = "Cp")
biplot(pca1)
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = FALSE,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
pca2 = princomp(pr, cor = T,center = TRUE,scale. = TRUE)
biplot(pca2)
screeplot(pca2)
par(mfrow = c(1,1))
pca1 = princomp(pr, cor = F,center = TRUE,scale. = TRUE)
biplot(pca1)
screeplot(pca1)
ret<-exp(diff(log(pr)))-1
ret<-exp(diff(log(pr)))-1
pca3= princomp(ret, cor = T,center = TRUE,scale. = TRUE)
biplot(pca3)
screeplot(pca3)
biplot(pca1)
pca1 = princomp(pr, cor = FALSE)
biplot(pca1)
sym1 = c("MMM","AXP","AAPL","BA","CAT","CVX","CSCO","KO","DD","XOM","GE",
"GS","HD","IBM","INTC","JNJ","JPM","MCD","MRK","MSFT","NKE","PFE",
"PG","TRV","UNH","UTX","VZ","V","WMT","DIS")
web = NULL
title = NULL
stock = NULL
for (i in 1:length(sym1)){
web[i] = paste0("http://chart.finance.yahoo.com/table.csv?s=", sym1[i],"&a=0&b=1&c=2010&d=0&e=1&f=2011&g=d&ignore=.csv",sep = "")
title[i] = paste(sym1[i],".csv",sep = "")
download.file (web[i],title[i],quiet = FALSE)
}
pr1 = pr[-1,]
View(pr1)
pr1 - pr
pr2 = pr[-252,]
pr1 - pr2
ret1 = pr1 - pr2
pca3= princomp(ret1, cor = T,center = TRUE,scale. = TRUE)
biplot(pca3)
screeplot(pca3)
pca3= princomp(ret, cor = T,center = TRUE,scale. = TRUE)
biplot(pca3)
screeplot(pca3)
ret<-exp(diff(log(pr)))-1
ret - re1
ret - ret1
par(mfrow = c(1,1))
plot(summary(lm3)$rss,col = "red",main = "RSS of three mehods",ylab = "RSS")
points(summary(lm4)$rss,col = "blue")
points(summary(lm5)$rss,col = "green")
leg.txt = c("optional","forward","backward ")
legend("topright",leg.txt,pch = 1,col= c("red","blue","green"))
?plot
plot(summary(lm3)$rss,pch = 0,main = "RSS of three mehods",ylab = "RSS")
points(summary(lm4)$rss,pch = 1)
points(summary(lm5)$rss,pch = 2)
plot(summary(lm3)$rss,pch = 0,main = "RSS of three mehods",ylab = "RSS")
points(summary(lm4)$rss,pch = 2)
points(summary(lm5)$rss,pch = 4)
leg.txt = c("optional","forward","backward ")
legend("topright",leg.txt,pch = 1, pch= c(0,2,4))
legend("topright",leg.txt,pch= c(0,2,4))
for( i in 1:length(sym1))
{
stock = read.csv(title[i],header = T)
m = stock$Close
pr[,i] = m
}
colnames(pr) = sym1
str(pr)
View(pr)
pca1 = princomp(pr, cor = FALSE)
biplot(pca1)
screeplot(pca1)
pca2 = princomp(pr, cor = T,center = TRUE,scale. = TRUE)
biplot(pca2)
screeplot(pca2)
return = NULL
for (i in 1:30){
return[i] = exp(diff(log(pr[i]))) - 1
}
ret<-exp(diff(log(pr)))-1
pr1 = pr[-1,]
pr2 = pr[-252,]
ret1 = pr1 - pr2
pca3= princomp(ret, cor = T,center = TRUE,scale. = TRUE)
pca3= princomp(ret1, cor = T,center = TRUE,scale. = TRUE)
biplot(pca3)
screeplot(pca3)
leg.txt = c("exhaustive","forward","backward ")
plot(summary(lm3)$rss,pch = 0,main = "RSS of three mehods",ylab = "RSS")
points(summary(lm4)$rss,pch = 2)
points(summary(lm5)$rss,pch = 4)
leg.txt = c("exhaustive","forward","backward ")
legend("topright",leg.txt,pch= c(0,2,4))
